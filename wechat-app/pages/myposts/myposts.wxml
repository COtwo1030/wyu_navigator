<navigation-bar extClass="nav-default" title="{{'我发布的'}}" back="{{true}}" color="black" background="#FFF" animated="{{false}}"></navigation-bar>
<view class="myposts">
  <view class="topbar">
    <button class="nav-delete-btn" bindtap="toggleDeleteMode">删除</button>
  </view>
  <view class="toolbar" wx:if="{{deleteMode}}">
    <button class="select-all-btn" bindtap="onSelectAllTap">全选</button>
  </view>
  <scroll-view scroll-y class="list">
    <block wx:for="{{articles}}" wx:key="id">
      <view class="card" bindtap="onCardTap" data-id="{{item.id}}">
        <image wx:if="{{deleteMode}}" class="del-icon" src="{{selectedMap[item.id] ? '/images/tabbar/delete_active.png' : '/images/tabbar/delete.png'}}" mode="aspectFit" catchtap="onToggleSelectTap" data-id="{{item.id}}"></image>
        <view class="card-body {{deleteMode ? 'shifted' : ''}}">
          <view wx:if="{{item.tag}}" class="tag">#{{item.tag}}</view>
          <view class="content">{{item.content}}</view>
          <block wx:if="{{item.imgs && item.imgs.length}}">
            <view class="imgs-grid">
              <block wx:for="{{item.imgs}}" wx:key="*this" wx:for-item="img" wx:for-index="idx">
                <view wx:if="{{idx < 3}}" class="img-wrap" catchtap="onPreviewImages" data-id="{{item.id}}" data-idx="{{idx}}">
                  <image class="img-item" src="{{img}}" mode="aspectFill"></image>
                  <view wx:if="{{idx === 2 && item.imgs.length > 3}}" class="more-mask">+{{item.imgs.length - 3}}</view>
                </view>
              </block>
            </view>
          </block>
        </view>
      </view>
    </block>
  </scroll-view>
  <view wx:if="{{deleteMode}}" class="delete-bar">
    <button class="confirm-delete-btn" bindtap="onConfirmDeleteTap">确认删除</button>
  </view>
</view>
